

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vector Function Spaces &#8212; The Bempp Book</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/spanels-index--0afa1ebdab0bb23b98b56d34c23d9f57.css" />
    <link rel="stylesheet" type="text/css" href="../_static/spanels-variables--ffc7f74dcb1b9eecba2dbcbc22818714.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://bempp.com/handbook/api/vector_function_spaces.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Function Spaces on Segments" href="segment_spaces.html" />
    <link rel="prev" title="Scalar Function Spaces" href="scalar_function_spaces.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">


<!-- Opengraph tags -->
<meta property="og:url"         content="https://bempp.com/handbook/api/vector_function_spaces.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Vector Function Spaces" />
<meta property="og:description" content="Vector Function Spaces  The following vector-valued spaces are supported in Bempp:        Space Type  Order  Description  &#34;RWG&#34;  0  Rao–Wilson–Glisson Hdiv func" />
<meta property="og:image"       content="https://bempp.com/handbook/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Bempp Book</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  API Overview
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="grids.html">
   Grids
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="function_spaces.html">
   Function Spaces
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="creating_function_spaces.html">
     Defining a function space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scalar_function_spaces.html">
     Scalar Function Spaces
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Vector Function Spaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="segment_spaces.html">
     Function Spaces on Segments
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="grid_functions.html">
   Grid Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boundary_operators.html">
   Boundary Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solvers.html">
   Linear Solvers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="potential_operators.html">
   Potential Operators
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  A dive into the Bempp core routines
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../core/assembling_operators.html">
   Assembling Operators
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Mathematical background of boundary integral equations
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../theory/function_spaces.html">
   Function Spaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../theory/discrete_function_spaces.html">
   Discrete Function Spaces
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/api/vector_function_spaces.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rwg-and-snc-spaces">
   RWG and SNC spaces
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#barycentric-dual-spaces">
   Barycentric dual spaces
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="vector-function-spaces">
<h1>Vector Function Spaces<a class="headerlink" href="#vector-function-spaces" title="Permalink to this headline">¶</a></h1>
<p>The following vector-valued spaces are supported in Bempp:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Space Type</p></th>
<th class="head"><p>Order</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;RWG&quot;</span></code></p></td>
<td><p>0</p></td>
<td><p>Rao–Wilson–Glisson Hdiv functions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;SNC&quot;</span></code></p></td>
<td><p>0</p></td>
<td><p>Scaled Nédélec Hcurl functions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;BC&quot;</span></code></p></td>
<td><p>0</p></td>
<td><p>Buffa–Christiansen Hdiv functions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;RBC&quot;</span></code></p></td>
<td><p>0</p></td>
<td><p>Rotated Buffa–Christiansen Hcurl functions</p></td>
</tr>
</tbody>
</table>
<p>When solving Maxwell’s equations, the correct combination of Hdiv and Hcurl spaces must be used.</p>
<div class="section" id="rwg-and-snc-spaces">
<h2>RWG and SNC spaces<a class="headerlink" href="#rwg-and-snc-spaces" title="Permalink to this headline">¶</a></h2>
<p>RWG and SNC spaces are vector-valued spaces, whose values are tangential to the surface triangles.
Between cells, RWG functions are continuous normal
to the triangle’s edges, while SNC spaces are continuous tangential to the triangle’s edges.
Example RWG (left) and SNC (right) basis functions are shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">rwg_and_snc</span></code>.</p>
<div class="figure align-default" id="rwg-and-snx">
<a class="reference internal image-reference" href="../_images/rwg_and_snc.png"><img alt="../_images/rwg_and_snc.png" src="../_images/rwg_and_snc.png" style="height: 200px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">An RWG and a SNC basis function</span><a class="headerlink" href="#rwg-and-snx" title="Permalink to this image">¶</a></p>
</div>
<p>These spaces can be created in Bempp with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rwg_space</span> <span class="o">=</span> <span class="n">bempp</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">function_space</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s2">&quot;RWG&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">snc_space</span> <span class="o">=</span> <span class="n">bempp</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">function_space</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s2">&quot;SNC&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The DOFs of RWG and SNC spaces are at the midpoints of the edges of each cell.</p>
</div>
<div class="section" id="barycentric-dual-spaces">
<h2>Barycentric dual spaces<a class="headerlink" href="#barycentric-dual-spaces" title="Permalink to this headline">¶</a></h2>
<p>Like the scalar DUAL spaces, BC and RBC spaces are defined on the barycentrically refined grid.
This grid is formed by joining
each vertex of every triangle with the centre of the opposite side, as shown in <a class="reference internal" href="#bary-mesh"><span class="std std-numref">Fig. 6</span></a>.</p>
<div class="figure align-default" id="bary-mesh">
<a class="reference internal image-reference" href="../_images/barycentric_mesh.png"><img alt="../_images/barycentric_mesh.png" src="../_images/barycentric_mesh.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Barycentrically refining a grid</span><a class="headerlink" href="#bary-mesh" title="Permalink to this image">¶</a></p>
</div>
<p>BC and RBC spaces are combinations of RWG and SNC (repectively) spaces on the barycentric grid,
and are defined in
<a class="reference external" href="https://www.jstor.org/stable/40234460?seq=1"><em>A dual finite element complex on the barycentric refinement</em> (2007) by A. Buffa and S. Christiansen</a>.
Example BC (left) and RBC (right) basis functions are shown in <a class="reference internal" href="#bc-and-rbc"><span class="std std-numref">Fig. 7</span></a>.</p>
<div class="figure align-default" id="bc-and-rbc">
<a class="reference internal image-reference" href="../_images/bc_and_rbc.png"><img alt="../_images/bc_and_rbc.png" src="../_images/bc_and_rbc.png" style="height: 200px;" /></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">A BC and a RBC basis function</span><a class="headerlink" href="#bc-and-rbc" title="Permalink to this image">¶</a></p>
</div>
<p>These spaces can be created in Bempp with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bc_space</span> <span class="o">=</span> <span class="n">bempp</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">function_space</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">rbc_space</span> <span class="o">=</span> <span class="n">bempp</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">function_space</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s2">&quot;RBC&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>The DOFs of BC and RBC spaces are at the midpoints of the edges of each cell (or equivalently at
a point on the edges of the barycentric dual cells).</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./api"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="scalar_function_spaces.html" title="previous page">Scalar Function Spaces</a>
    <a class='right-next' id="next-link" href="segment_spaces.html" title="next page">Function Spaces on Segments</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Timo Betcke and Matthew Scroggs<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>